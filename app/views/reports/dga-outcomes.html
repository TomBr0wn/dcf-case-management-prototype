{% extends "layouts/main.html" %}

{% set pageName = case.reference %}

{% block beforeContent %}
  {{ govukBreadcrumbs({
    items: [
      {
        text: "All reports",
        href: "/reports"
      },
      {
        text: "Director General Assessment"
      }
    ]
  }) }}
{% endblock %}

{% block content %}
  {% if successMessage %}
    {{ govukNotificationBanner({
      type: "success",
      html: "<h3 class=\"govuk-notification-banner__heading\">Success</h3><p class=\"govuk-body\">" + successMessage + "</p>"
    }) }}
  {% endif %}

  <span class="govuk-caption-l">{{ case.reference }}</span>
  <h1 class="govuk-heading-l">Record outcomes</h1>

  <p class="govuk-body">Select each reason for failure and record the dispute outcome.</p>

  {% if case.dga.failureReasons.length %}
    <table class="govuk-table">
      <thead class="govuk-table__head">
        <tr class="govuk-table__row">
          <th scope="col" class="govuk-table__header">Reason for failure</th>
          <th scope="col" class="govuk-table__header">Outcome</th>
          <th scope="col" class="govuk-table__header">Status</th>
        </tr>
      </thead>
      <tbody class="govuk-table__body">
        {% for reason in case.dga.failureReasons %}
          <tr class="govuk-table__row">
            <td class="govuk-table__cell">
              <a href="/reports/{{ case.id }}/dga-outcomes/{{ reason.id }}/dga-select-outcome" class="govuk-link">
                {{ reason.reason }}
              </a>
            </td>
            <td class="govuk-table__cell">
              {% if reason.outcome %}
                {{ reason.outcome }}
              {% else %}
                -
              {% endif %}
            </td>
            <td class="govuk-table__cell">
              {% if reason.outcome %}
                Completed
              {% else %}
                Not started
              {% endif %}
            </td>
          </tr>
        {% endfor %}
      </tbody>
    </table>
  {% else %}
    <p class="govuk-body">No failure reasons found for this case.</p>
  {% endif %}

{% endblock %}